[FireMon - Daily Policy Import]
action.summary_index = 0
cron_schedule = 0 2 * * *
dispatch.earliest_time = -1d@d
dispatch.latest_time = @d
enableSched = 1
search = | inputlookup firemon_policy_data.csv | collect index=main sourcetype=firemon_policy_data

[FireMon - High Risk Rules]
cron_schedule = 15 * * * *
dispatch.earliest_time = -1h
dispatch.latest_time = now
enableSched = 1
search = index=main sourcetype=firemon_rules risk_score>=8

[FireMon - Unused Rules in Last 90 Days]
cron_schedule = 30 1 * * *
dispatch.earliest_time = -90d
dispatch.latest_time = now
enableSched = 1
search = index=main sourcetype=firemon_rules usage_count=0

[FireMon - Devices Without Recent Reports]
cron_schedule = 45 3 * * *
dispatch.earliest_time = -30d
dispatch.latest_time = now
enableSched = 1
search = index=main sourcetype=firemon_devices | stats max(report_timestamp) as last_report by device_name | where last_report < relative_time(now(), "-30d")

[FireMon - User Access Audit]
cron_schedule = 0 */6 * * *
dispatch.earliest_time = -1d
dispatch.latest_time = now
enableSched = 1
search = index=main sourcetype=firemon_users | stats values(role) as roles by username, email

[FireMon - Risk Score Trends]
cron_schedule = 0 4 * * *
dispatch.earliest_time = -7d@d
dispatch.latest_time = @d
enableSched = 1
search = index=main sourcetype=firemon_policy_data | timechart avg(risk_score) by policy_id

[FireMon - Rule Cleanup Candidates]
cron_schedule = 0 5 * * *
dispatch.earliest_time = -30d
dispatch.latest_time = now
enableSched = 1
search = index=main sourcetype=firemon_rules usage_count=0 action=allow | stats count by policy_name, rule_id

[FireMon - Top 10 Rule Violators]
cron_schedule = 0 */2 * * *
dispatch.earliest_time = -1d
dispatch.latest_time = now
enableSched = 1
search = index=main sourcetype=firemon_rules | top limit=10 rule_id by violations

[FireMon - License Expiry Check]
cron_schedule = 0 0 * * *
dispatch.earliest_time = -1d
dispatch.latest_time = now
enableSched = 1
search = index=main sourcetype=firemon_licenses | where expiration < relative_time(now(), "+30d")
